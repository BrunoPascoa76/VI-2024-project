<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        /* Basic styling for the bars */
        .bar {
            fill: steelblue;
        }
        .bar-chart-bar {
            fill: orange;
        }
        .container {
            display: flex;
            gap: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <svg id="histogram" width="600" height="400"></svg>
        <svg id="barchart" width="300" height="400"></svg>
    </div>
    
    <script>
        // Dimensions for histogram
        const histWidth = 600;
        const histHeight = 400;
        const histSvg = d3.select("#histogram")
            .attr("width", histWidth)
            .attr("height", histHeight);

        // Dimensions for bar chart
        const barWidth = 300;
        const barHeight = 400;
        const barSvg = d3.select("#barchart")
            .attr("width", barWidth)
            .attr("height", barHeight);

        // Histogram setup
        const margin = { top: 20, right: 30, bottom: 30, left: 40 };
        const innerWidth = histWidth - margin.left - margin.right;
        const innerHeight = histHeight - margin.top - margin.bottom;
        
        const xHist = d3.scaleLinear()
            .domain([0, 100]) // Data range
            .range([0, innerWidth]);

        const yHist = d3.scaleLinear()
            .range([innerHeight, 0]);

        const histG = histSvg.append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        const xAxisHist = histG.append("g")
            .attr("transform", `translate(0,${innerHeight})`);
        
        const yAxisHist = histG.append("g");

        // Bar chart setup
        const barG = barSvg.append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        const xBar = d3.scaleBand()
            .range([0, barWidth - margin.left - margin.right])
            .padding(0.1);

        const yBar = d3.scaleLinear()
            .range([innerHeight, 0]);

        const xAxisBar = barG.append("g")
            .attr("transform", `translate(0,${innerHeight})`);
        
        const yAxisBar = barG.append("g");

        // Function to generate random data
        function generateData(size) {
            return Array.from({length: size}, () => Math.floor(Math.random() * 100));
        }

        // Function to update the histogram
        function updateHistogram(data) {
            const bins = d3.bin().domain(xHist.domain()).thresholds(xHist.ticks(20))(data);

            yHist.domain([0, d3.max(bins, d => d.length)]);

            const bars = histG.selectAll(".bar")
                .data(bins);

            bars.enter().append("rect")
                .attr("class", "bar")
                .attr("x", d => xHist(d.x0))
                .attr("width", d => xHist(d.x1) - xHist(d.x0) - 1)
                .attr("y", innerHeight)
                .attr("height", 0)
                .transition()
                .duration(1000)
                .attr("y", d => yHist(d.length))
                .attr("height", d => innerHeight - yHist(d.length));

            bars.transition()
                .duration(1000)
                .attr("x", d => xHist(d.x0))
                .attr("width", d => xHist(d.x1) - xHist(d.x0) - 1)
                .attr("y", d => yHist(d.length))
                .attr("height", d => innerHeight - yHist(d.length));

            bars.exit().transition()
                .duration(1000)
                .attr("y", innerHeight)
                .attr("height", 0)
                .remove();

            xAxisHist.transition().call(d3.axisBottom(xHist));
            yAxisHist.transition().call(d3.axisLeft(yHist));
        }

        // Function to update the bar chart
        function updateBarChart(data) {
            const categories = data.slice(0, 10);  // Use only 10 categories for bar chart

            xBar.domain(d3.range(categories.length));
            yBar.domain([0, d3.max(categories)]);

            const bars = barG.selectAll(".bar-chart-bar")
                .data(categories);

            bars.enter().append("rect")
                .attr("class", "bar-chart-bar")
                .attr("x", (d, i) => xBar(i))
                .attr("width", xBar.bandwidth())
                .attr("y", innerHeight)
                .attr("height", 0)
                .transition()
                .duration(1000)
                .attr("y", d => yBar(d))
                .attr("height", d => innerHeight - yBar(d));

            bars.transition()
                .duration(1000)
                .attr("x", (d, i) => xBar(i))
                .attr("width", xBar.bandwidth())
                .attr("y", d => yBar(d))
                .attr("height", d => innerHeight - yBar(d));

            bars.exit().transition()
                .duration(1000)
                .attr("y", innerHeight)
                .attr("height", 0)
                .remove();

            xAxisBar.transition().call(d3.axisBottom(xBar).tickFormat(i => i + 1));
            yAxisBar.transition().call(d3.axisLeft(yBar));
        }

        // Initial data load and periodic updates
        function updateCharts() {
            const data = generateData(100);
            updateHistogram(data);
            updateBarChart(data);
        }
        
        updateCharts(); // Initial load
        setInterval(updateCharts, 2000); // Update every 2 seconds
    </script>
</body>
</html>

