<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <style>
        body {
            font: 12px sans-serif;
        }
        
        svg {
            margin: 0px auto;
            display: block;
        }
        
        path.arc {
            opacity: 0.9;
            transition: opacity 0.5s;
        }
        
        path.arc:hover {
            opacity: 0.7;
        }
        
        .tooltip {
            position: absolute;
            display: none;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 3px;
            box-shadow: -3px 3px 15px #888;
            color: white;
            padding: 6px;
        }
    </style>
    <script src="https://d3js.org/d3.v4.min.js"></script>
</head>
<body>
    <script>
        const width = 960,
              height = 500,
              chartRadius = height / 2 - 40;
        
        const color = d3.scaleOrdinal(d3.schemeCategory10);
        
        let svg = d3.select('body').append('svg')
            .attr('width', width)
            .attr('height', height)
            .append('g')
                .attr('transform', 'translate(' + width / 2 + ',' + height / 2 + ')');
        
        let tooltip = d3.select('body').append('div')
            .attr('class', 'tooltip');
        
        const PI = Math.PI,
              arcMinRadius = 10,
              arcPadding = 10;
        
        // Generate random data
        const numArcs = 7;  // Number of arcs
        const data = Array.from({ length: numArcs }, (_, i) => ({
            name: `Category ${i + 1}`,
            value: Math.floor(Math.random() * 100) + 10  // Random values between 10 and 100
        }));
        
        // Scale for radial positioning
        const scale = d3.scaleLinear()
            .domain([0, d3.max(data, d => d.value) * 1.1])
            .range([0, 2 * PI]);

        // Calculate arc width
        const arcWidth = (chartRadius - arcMinRadius - numArcs * arcPadding) / numArcs;

        const arc = d3.arc()
            .innerRadius((d, i) => getInnerRadius(i))
            .outerRadius((d, i) => getOuterRadius(i))
            .startAngle(0)
            .endAngle((d, i) => scale(d.value));

        // Data arcs
        let arcs = svg.append('g')
            .attr('class', 'data')
            .selectAll('path')
            .data(data)
            .enter().append('path')
            .attr('class', 'arc')
            .style('fill', (d, i) => color(i))
            .attr('d', arc)
            .on('mousemove', showTooltip)
            .on('mouseout', hideTooltip);

        // Create paths for text positioning
        data.forEach((d, i) => {
            const startAngle = 0; // Start angle
            const endAngle = scale(d.value); // End angle
            
            // Create a path for each arc
            const pathD = arc({
                innerRadius: getInnerRadius(i),
                outerRadius: getOuterRadius(i),
                startAngle: startAngle,
                endAngle: endAngle
            });

            // Append the path
            svg.append('path')
                .attr('id', `path-${i}`)
                .attr('d', pathD)
                .style('fill', 'none') // Not visible
                .style('stroke', 'none'); // Not visible
        });

        // Position category names along the paths
        svg.selectAll('text')
            .data(data)
            .enter().append('text')
            .append('textPath')
            .attr('xlink:href', (d, i) => `#path-${i}`) // Reference the path
            .attr('startOffset', '50%') // Center the text on the path
            .attr('text-anchor', 'middle') // Center alignment
            .attr('dominant-baseline', 'middle') // Center the text vertically
            .text(d => d.name)
            .attr("fill", "white");

        // Rotate the text based on its position on the path
        svg.selectAll('textPath')
            .attr('transform', (d, i) => {
                const angle = (scale(d.value) / 2) * (180 / Math.PI) - 90; // Convert radians to degrees and adjust by -90
                return `rotate(${angle})`; // Rotate the text
            });

        function showTooltip(d) {
            tooltip.style('left', (d3.event.pageX + 10) + 'px')
                .style('top', (d3.event.pageY - 25) + 'px')
                .style('display', 'inline-block')
                .html(`Name: ${d.name}<br>Value: ${d.value}`);
        }

        function hideTooltip() {
            tooltip.style('display', 'none');
        }

        function getInnerRadius(index) {
            return arcMinRadius + (numArcs - (index + 1)) * (arcWidth + arcPadding);
        }

        function getOuterRadius(index) {
            return getInnerRadius(index) + arcWidth;
        }
    </script>
</body>
</html>

